## Динамика по префиксу и значению последнего элемента

Пусть, дана последовательность $a_1,\\ldots,a_n$, с максимальным
значением $A$. Требуется найти длину наибольшей такой
подпоследовательности, что ее элементы отличаются на более,
чем на 1. Воспользуемся динамическим программированием, где $dp\[j\]$
будет обозначать ответ с последним взятым элементом, равным $j$.
Будем обновлять и хранить актуалььным весь массив $dp$ целиком,
проходясь по массиву $a$ слева направо.

Соответственно для каждого $i$ переходы можно делать только из таких
$j$, что $|a\[i\]-j|\\leq 1$.

``` C++ numberLines
for (int i = 1; i <= n; I++) {
    dp[a[i]] += 1
    if (a[i] > 0) {
        dp[a[i]] = max(dp[a[i]], dp[a[i] - 1] + 1);
    }
    if (a[i] < A) {
        dp[a[i]] = max(dp[a[i]], dp[a[i] + 1] + 1);
    }
}
```

Это решение за $O(n + A)$.

Заметим, что вот эти две идеи встречаются в задачах наиболее часто:

  - хранить в $dp\[i\]$ ответ для $i$-ого префикса. Как в рюкзаке (где
    можно пользоваться $i$ первыми предметами), НВП(где ответ на
    префиксе длины $i$) и НОП (где ответ для префиксов длины $i$ и
    $j$).
  - хранить в $dp\[i\]$ ответ для последовательностей, заканчивающихся
    на $i$.