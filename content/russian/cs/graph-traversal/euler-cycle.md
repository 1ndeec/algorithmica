---
title: Эйлеров цикл
weight: 5
authors:
- Сергей Слотин
---

*Эйлеров путь* — это путь в графе, проходящий через все его рёбра.

*Эйлеров цикл* — это эйлеров путь, являющийся циклом.

Для простоты в обоих случаях будем считать, что граф неориентированный.

Также существует понятие *гамильтонова* пути и цикла — они посещают все *вершины* по разу, а не рёбра. Нахождение гамильтонова цикла (*задача коммивояжера*, англ. *travelling salesman problem*) — одна из самых известных NP-полных задач, в то время как нахождение эйлерового цика решается за линейное время — и мы сейчас покажем, как.

### Нахождение эйлерова цикла

**Теорема.** Эйлеров цикл существует тогда и только тогда, когда граф связный и степени всех вершин чётны.

**Доказательство.** Необходимость показывается так: можно просто взять эйлеров цикл и ориентировать все его ребра в порядке обхода. Тогда из каждой вершины будет выходить столько же рёбер, сколько входить, а значит степень у всех вершин исходного неориентированного графа была четной.

Достаточность докажем конструктивно — предъявим алгоритм нахождения.

```c++
const int maxn = 1e5;
set<int> g[maxn];

void euler(int v) {
    while (!g[v].empty()) {
        u = *g[v].begin();
        g[v].erase(g[v].begin());
        dfs(u);
    }
    cout << v <<  " ";
}
```

Если условие на четность степеней вершин выполняется, то этот алгоритм действительно выводит эйлеров цикл, то есть последовательность из $(m + 1)$ вершин, в которой между каждой парой соседей есть ребро, причём каждое ребро будет выписано ровно один раз.

### Эйлеров путь

Поговорим теперь про эйлеровы *пути*. Может, всё-таки можно что-нибудь сделать, даже если степени не всех вершин чётные?

Заметим, что, так как каждое ребро меняет четность степеней ровно двух вершин, и в пустом графе все степени изначально нулевые, то число вершин с нечетными степенями будет четным.

Если нечетных вершин ровно две, то можно сделать следующее: соединить их ребром, построить эйлеров цикл (ведь теперь степени всех вершин четные), а затем удалить это ребро из цикла. Если правильно сдвинуть этот цикл, мы получили эйлеров путь.

Альтернативно, можно просто запустить обход из одной из нечетных вершин и получить такой же результат.

Если нечетных вершин больше двух, то мы уже построить эйлеров путь не сможем, потому что любой эйлеров путь входит или покидает каждую вершину четное число раз, кроме, возможно двух своих концов.

**Следствие.** Эйлеров путь существует тогда и только тогда, когда граф связен и количество вершин с нечётными степенями не превосходит 2.

**Упражнение.** Дан связный неориентированный граф. Требуется покрыть его ребра наименьшим количеством непересекающихся путей. Асимптотика $O(n + m)$.

**Упражнение.** Сформулируйте и докажите аналогичные утверждения для случая ориентированного графа.
