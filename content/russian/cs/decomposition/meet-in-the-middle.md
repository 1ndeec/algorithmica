---
title: Meet-in-the-middle
---

Пусть мы умеем полным перебором находить ответ, допустим за $O(2^n \*
poly(n))$, где $poly(n)$ - полином от $n$, давайте теперь научимся
решать эту задачу за $O(2^{n / 2} \* poly(n))$

## Решение

Давайте разделим задачу на две части - и сначала решим честно перебором
за $O(2^{n / 2} \* poly(n))$, теперь сделаем следующее : запомним
ответы для всех вариантов в какое-то удобное для нас хранилище(в
общем случае нам подойдет hash-map), теперь насчитаем ответы для всех
вариантов в левой части и для каждого из них посмотрим есть ли
подходящий нам пример в правой части.

## Задача

Надо найти количество чисел $ \< 10^{30}$ из 1 и 2, делящихся на $M, 1
\< M \< 10^6$

## Решение

Переберем левую часть - запишем массив $cnt_{x}$ - количество чисел,
дающих остаток $x$ при делении на $M$. Затем переберём также правую
часть, пусть правая часть дает остаток $x$, тогда надо просто
прибавить к ответу $cnt_{M - x}$

Дана стандартная задача [Рюкзак](Рюкзак "wikilink"), давайте научимся ее
решать за $O(2^{n / 2} \* poly(n))$, где $n$ - количество предметов

## Решение

Мы умеем ее решать за $O(2^n \\cdot n)$, переберём все маски, для каждой
проверим полученную стоимость, выберем максимальную из подходящих.

Давайте теперь сделаем тоже самое только для левой части и затем для
каждого веса $x$ предпочитаем максимальную стоимость предметов с
весом $\\le x$ в массиве ans, теперь для каждой маски левой части
просто посмотрим сумму предметов - S и массой c и просто проверим S +
ans\[нужная масса - c\]

## Ограничения

Иногда в таких задачах есть подгруппа/или вся задача с маленьким $k$,
например $k \\leq 10^{14}$, решим задачу количество чисел \< $k$ с
суммой цифр - $s$

## Альтернативное решение без ДП по цифрам

Давайте разделим число на левую часть(большие 7 разрядов) и
правую(меньшие 7 разрядов). Давайте для всех чисел правой
части предподсчитаем, сколько из них имеют сумму $x$ и запишем это в
массив подсчет, затем будем перебирать левую часть, пусть и числа из
левой части сумма - $x$, тогда нам нужно найти количество правых
частей с суммой $S - x$(это просто обращение к массиву подсчета),
тогда мы научились решать задачу за $\\sqrt(k)$
