---
title: Наименьший общий предок
weight: 25
---

Для большого класса задач требуется решить следующую вспомогательную задачу:

> Дано корневое дерево. Требуется отвечать на запросы нахождения наименьшего общего предка вершин $u_i$ и $v_i$, то есть вершины $w$, которая лежит на пути от корня до $u_i$, на пути от корня до $v_i$, и при этом самую глубокую (нижнюю) из всех таких.

По-английский эта задача называется *least common ancestor* — наименьший общий предок.

![Вершина $i$ является LCA для вершин $k$ и $n$](img/lca.png)

Для лучшего понимания — медленно (за линейное время) наименьшего общего предка можно искать так:

```c++
bool a (int u, int v) {
    return tin[u] <= tin[v] && tin[v] < tout[u];
}

int lca (int u, int v) {
    while (!ancestor(u, v))
        u = p[u];
    return u;
}
```

Есть много разных способов её решать быстрее, и в этой главе рассмотрим основные.
