---
title: Сортировка кучей
authors:
  - Денис Акилов
weight: 6
created: "2021"
prerequisites:
  - selection
  - /cs/basic-structures/heap
---

Давайте воспользуемся идеей [сортировки выбором](/cs/sorting/selection). У нас нет проблемы быстро добавлять в отсортированную часть новый минимум. Причина, по которой алгоритм работает за квадратичное время — это линейный поиск минимума и удаление этого минимума в некоторой структуре. Это же ровно то, что умеет делать [двоичная куча](/cs/basic-structures/heap), но быстрее! Давайте воспользуемся ей и получим время работы $O(n \log n)$:

```cpp
void heap_sort(int* a, int n) {
  // копируем массив в кучу
  t_n = n;
  copy(a, a + n, t + 1);
  build_heap();
  for (int i = 1; i <= n; ++i) {
    // удаляем минимум, он останется в ячейке t[n + 1 - i]
    swap(t[1], t[n + 1 - i]);
    --t_n;
    sift_down(1);
  }
  // получили массив t[1..n], в котором все элементы упорядочены по убыванию
  reverse(t, t + n + 1);
  copy(t, t + n, a);
}
```
